<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lune Hosting | Pagamento</title>
    <link rel="stylesheet" href="style.css">
    <style>
        main {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 80vh;
            text-align: center;
        }
        #pix-qr-code {
            margin-top: 20px;
            display: none; /* Initially hidden */
        }

        .quase-la {
            color: white;
            font-weight: bold;
            font-size: 60px;
        }

        .desc {
            color: rgb(179, 179, 179);
            font-weight: bold;
            font-size: 20px;
        }
    </style>
</head>
<body>

    <header>
        <h1>
            <img src="https://i.imgur.com/feIQmi4.png" alt="Logo Lune" style="width: 70px; height: auto; vertical-align: middle; margin-right: 10px;">
            Lune Hosting
        </h1>
        <div class="header-buttons">
            <a href="index.html"><button>Retornar</button></a>
        </div>
    </header>

    <main>
        <h2 id="plan-name"></h2>
        <p class="quase-la">Quase lá!</p>
        <p class="desc">Agora você pode pagar com um Cartão de Crédito ou realizar um pagamento via Pix:</p>

        <!-- Botão do PayPal -->
        <div id="paypal-button-container"></div>

        <!-- QR Code do Pix -->
        <div id="pix-qr-code">
            <h3>Faça o pagamento via Pix (MANUTENÇÃO):</h3>
            <img id="pix-qr" src="" alt="QR Code" style="width: 200px; height: 200px;">
            <p>Escaneie o QR Code para realizar o pagamento.</p>
        </div>
    </main>

    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-section">
                <h3>Formas de pagamento</h3>
                <div class="payment-icons">
                    <img src="https://img.icons8.com/color/512/pix.png" alt="Pix">
                    <img src="https://cdn-icons-png.flaticon.com/512/6963/6963703.png" alt="Cartão de Crédito">
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Lune Hosting © 2025 - Todos os direitos reservados.</p>
        </div>
    </footer>

    <script src="https://www.paypal.com/sdk/js?client-id=ASNolNlpVykBfRlKLeUj45P-G16GMfZSyX5j3pwa00S8YZmjL9yuBFBco6_Hs9NAx7kLS-m8ujJYuYgK&currency=BRL"></script>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const planName = urlParams.get('plano') ? decodeURIComponent(urlParams.get('plano')) : "Plano Desconhecido";
        const planPrice = urlParams.get('preco') ? parseFloat(urlParams.get('preco')) : 0;

        console.log("Plan Name:", planName);
        console.log("Plan Price:", planPrice);

        if (!planPrice || planPrice <= 0) {
            alert("Erro: preço inválido.");
        } else {
            paypal.Buttons({
                createOrder: function(data, actions) {
                    return actions.order.create({
                        purchase_units: [{
                            amount: { value: planPrice.toFixed(2) },
                            description: `Plano: ${planName}`
                        }]
                    });
                },
                onApprove: function(data, actions) {
                    return actions.order.capture().then(function(details) {
                        alert('Pagamento concluído! Obrigado, ' + details.payer.name.given_name);
                        window.location.href = 'sucesso.html';
                    });
                },
                onCancel: function(data) {
                    alert('Pagamento cancelado.');
                },
                onError: function(err) {
                    console.error("Erro no PayPal:", err);
                    alert('Ocorreu um erro ao processar o pagamento.');
                }
            }).render('#paypal-button-container');

            const pixQRCodeUrl = "https://www.gerencianet.com.br/pix/api/generate-qr-code";

            setTimeout(function() {
                document.getElementById("pix-qr-code").style.display = "block";
                document.getElementById("pix-qr").src = "https://www.gerencianet.com.br/pix/api/qrcode?chave=18998101640";
            }, 500);
        }
    </script>

</body>
</html>